"use strict";(self["webpackChunkdiploma"]=self["webpackChunkdiploma"]||[]).push([[275],{1275:function(t,e,r){r.r(e),r.d(e,{default:function(){return B}});var i=r(641);const o={class:"catalog product-list"},c={class:"category-buttons"},a={class:"products-and-filter"},s={class:"products"},n={class:"product-card-container"};function l(t,e,r,l,d,u){const p=(0,i.g2)("FilterCatalog"),m=(0,i.g2)("ProductCard");return(0,i.uX)(),(0,i.CE)("div",o,[(0,i.Lk)("ul",c,[(0,i.Lk)("li",{onClick:e[0]||(e[0]=t=>u.filterByCategory("pencils"))},"Карандаши"),(0,i.Lk)("li",{onClick:e[1]||(e[1]=t=>u.filterByCategory("brushes"))},"Кисти"),(0,i.Lk)("li",{onClick:e[2]||(e[2]=t=>u.filterByCategory("paper"))},"Бумага"),(0,i.Lk)("li",{onClick:e[3]||(e[3]=t=>u.filterByCategory("palettes"))},"Палитры"),(0,i.Lk)("li",{onClick:e[4]||(e[4]=t=>u.filterByCategory("all"))},"Все")]),(0,i.Lk)("div",a,[(0,i.bF)(p,{onUpdatePriceFilter:u.handlePriceFilterUpdate},null,8,["onUpdatePriceFilter"]),(0,i.Lk)("div",s,[(0,i.Lk)("div",n,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(u.visibleProducts,(t=>((0,i.uX)(),(0,i.Wv)(m,{key:t.id,product:t},null,8,["product"])))),128)),u.moreProductsToShow?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"look-more",onClick:e[5]||(e[5]=(...t)=>u.showMoreProducts&&u.showMoreProducts(...t))}," ЗАГРУЗИТЬ ЕЩЕ ")):(0,i.Q3)("",!0)])])])])}r(8992),r(4520);var d=r(33);const u={class:"product-card"},p=["src"],m={class:"price"};function h(t,e,r,o,c,a){return(0,i.uX)(),(0,i.CE)("div",u,[(0,i.Lk)("img",{src:r.product.image,alt:"Изображение товара"},null,8,p),(0,i.Lk)("div",null,[(0,i.Lk)("p",m,(0,d.v_)(r.product.price)+" ₽",1),(0,i.Lk)("h3",null,(0,d.v_)(r.product.name),1),(0,i.Lk)("p",null,[e[1]||(e[1]=(0,i.Lk)("strong",null,"Количество:",-1)),(0,i.eW)(" "+(0,d.v_)(r.product.quantity),1)]),(0,i.Lk)("button",{onClick:e[0]||(e[0]=(...t)=>o.addToCart&&o.addToCart(...t))},"Добавить в корзину")])])}r(4114),r(2577),r(1454);var k=r(6278),P={props:{product:{type:Object,required:!0}},setup(t){const e=(0,k.Pj)(),r=async()=>{const e=parseInt(sessionStorage.getItem("userId"));if(e){const i={id:null,product:{id:null,name:t.product.name,category:t.product.category,quantity:1,price:t.product.price,description:t.product.description,image:t.product.image}};try{const r=await fetch("https://faa45a9033a909b4.mokky.dev/users",{method:"GET"});if(!r.ok)throw new Error(`Ошибка при получении пользователей: ${r.status} ${r.statusText}`);const o=await r.json();if(!o||0===o.length)return void alert("Пользователь не найден.");const c=o.find((t=>t.id===e)),a=c.items||[],s=c.items.find((e=>e.product.name===t.product.name));if(s)s.product.quantity+=1;else{const t=a.map((t=>t.id)),e=t.length>0?Math.max(...t)+1:1;i.id=e,i.product.id=e,a.push(i)}fetch(`https://faa45a9033a909b4.mokky.dev/users?id=${e}`,{method:"PATCH",body:JSON.stringify(o),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((t=>t.json())).then((t=>console.log(t))),alert(`Товар "${t.product.name}" добавлен в корзину!`)}catch(r){console.error(r),alert("Ошибка при добавлении товара в корзину")}}else i(t.product)},i=t=>{const r=e.state.cart.find((e=>e.id===t.id));r?r.quantity+=1:e.commit("addToStore",{...t,quantity:1}),alert(`Товар "${t.name}" добавлен в локальную корзину!`)};return{addToCart:r}}},f=r(6262);const y=(0,f.A)(P,[["render",h],["__scopeId","data-v-2f25636e"]]);var C=y,v=r(3751);const g={class:"filter"},b={class:"price-filter"},L={class:"slider-container"},x={class:"min-price"},w=["min"],F={class:"max-price"};function _(t,e,r,o,c,a){return(0,i.uX)(),(0,i.CE)("div",g,[e[0]||((0,i.Vq)(-1,!0),(e[0]=(0,i.Lk)("h3",null,[e[4]||(e[4]=(0,i.eW)("Цена:"))])).cacheIndex=0,(0,i.Vq)(1),e[0]),(0,i.Lk)("div",b,[e[1]||((0,i.Vq)(-1,!0),(e[1]=(0,i.Lk)("label",null,[e[5]||(e[5]=(0,i.eW)("Ценовой диапазон:"))])).cacheIndex=1,(0,i.Vq)(1),e[1]),(0,i.Lk)("div",L,[(0,i.Lk)("span",x,(0,d.v_)(c.minPrice)+"₽",1),(0,i.bo)((0,i.Lk)("input",{type:"range","onUpdate:modelValue":e[2]||(e[2]=t=>c.maxPrice=t),min:c.minPrice,max:1e4,onInput:e[3]||(e[3]=(...t)=>a.updateFilters&&a.updateFilters(...t)),class:"slider"},null,40,w),[[v.Jo,c.maxPrice]]),(0,i.Lk)("span",F,(0,d.v_)(c.maxPrice)+"₽",1)]),(0,i.Lk)("p",null,"Искать товары до "+(0,d.v_)(c.maxPrice)+"₽",1)])])}var T={data(){return{minPrice:0,maxPrice:1e4}},methods:{updateFilters(){this.$emit("update-price-filter",{minPrice:this.minPrice,maxPrice:this.maxPrice})}}};const q=(0,f.A)(T,[["render",_],["__scopeId","data-v-654bfdb6"]]);var I=q,E={components:{ProductCard:C,FilterCatalog:I},data(){return{products:[],selectedCategory:"all",visibleCount:4,minPrice:null,maxPrice:null}},async mounted(){try{const t=await fetch("https://faa45a9033a909b4.mokky.dev/catalog",{method:"GET"});if(!t.ok)throw new Error("Сервер вернул неверный ответ");const e=await t.json();this.products=e}catch(t){console.error("Ошибка при получении данных:",t)}},computed:{filteredProducts(){return this.products.filter((t=>{const e="all"===this.selectedCategory||t.category===this.selectedCategory,r=(null===this.minPrice||t.price>=this.minPrice)&&(null===this.maxPrice||t.price<=this.maxPrice);return e&&r}))},visibleProducts(){return this.filteredProducts.slice(0,this.visibleCount)},moreProductsToShow(){return this.filteredProducts.length>this.visibleCount}},methods:{filterByCategory(t){this.selectedCategory=t,this.visibleCount=4},showMoreProducts(){this.visibleCount+=4},handlePriceFilterUpdate({minPrice:t,maxPrice:e}){this.minPrice=t,this.maxPrice=e,this.visibleCount=4}}};const j=(0,f.A)(E,[["render",l],["__scopeId","data-v-d13c929c"]]);var B=j}}]);
//# sourceMappingURL=275.d7ec7eca.js.map