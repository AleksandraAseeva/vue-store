"use strict";(self["webpackChunkdiploma"]=self["webpackChunkdiploma"]||[]).push([[208],{5128:function(t,e,a){a.r(e),a.d(e,{default:function(){return X}});var l=a(641);const r={class:"cart"};function n(t,e,a,n,i,o){const s=(0,l.g2)("CartComponent");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",r,[e[0]||((0,l.Vq)(-1,!0),(e[0]=(0,l.Lk)("h1",null,[e[1]||(e[1]=(0,l.eW)("Корзина"))])).cacheIndex=0,(0,l.Vq)(1),e[0])]),(0,l.bF)(s)],64)}var i=a(3751),o=a(33),s=a.p+"img/i.b842c310.png",c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAABuwAAAbsBOuzj4gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAR5SURBVHic7Zs9bBxFGIafL4edHyUoivkxBSSKi6QIUSAJPw1OS0EXJBpLSBE1BQUFhaFKlQJRJBJKG6R0UVJGckkw4UeQIokEEqbhx0EROMLENh/FjH2zc7c7M3e7e3thX2mkm/E7373f652dmd05VJWqCjADXAS+B9YBjSzrts9FYKZSjRUmPwesJCSdV1aAuap0ihVbKkTkBeALYKKkkGvAy6r6TUnxtlCVAZ8DrzhN/wKLwGpkiB3AS8A2p+2Gqr5ajsIuSjdARHYBfwId23QfOKGqPyTGmQFuAntt0wawR1X/LksrZB0uC0foJg9wKTV5ANvnktPUAZ4fUlsPqjBgl1f/fYhYfl8/9tB4rOiPIvI0cBLj/PbImPu9+ikR+TBdGgCzXv1tETkV2fcfzFT6par+msvKmcImgI8wd99hp7FRlzWby0T0OgC40gDhZZcrUQYAZxogtqpyJrgQEpGbwHGn6SrwKWZqGyc8DrwDvOG0faWqJ1xSxgARmQT+AiZt0xJwUFU3qtVaDUSkA/wIPGebHmLWEg83Of40+Azd5AEWxjV5AKt9wWmaxOS4Bd8AqVpUA5DN0bsBHmD0N6qqywE3Z/8KUB59ZHL0DVgC7tanpXbcxeS4hcxSWFVVRN4E3sMsafcALzqUnzF31SbjIPCsU/8aM7P9BJxTf94PPNU5THb8nK/qyUyJT6LOe5oPF/FDu0F/N/bkIP+SmuFrLNyNhgz4A/MgYhNPDaKoZrgaNzA55KLQADte7jlNhVeAiOwUkTkRORpSKQav2xJcf4jIURt7Z4DqarzXM+Z9RIypW3TH03KAu+BwZwPceYc7H+DOOtyFAHfZ4d4K5hdhgJvUBtDJ4U2TvflcCMS97XBvB7gXvNjTObyO1RhlVsxNELI3kW3AVA5vR6BexE/hFvGnyA7r4OO4VAOg2TNB0gwArQGtAa0BEUGXA1/SJPjafO09GOQKaPJq0NfWDoFQh9gh4C4nx8UApYwhoKrrmDe8/b6kaXC13bfaCxH7ctS9lMbFgKiXsoMYMBWze6sbVpO7TK/MgA6wL7JfndhH9lxCZQZAM4dB8gwArQGtAY+SAcmrQBjcgCYuh//3V0BrgFcv1YBx2BInb4Uh0gBVXcUcWs77sibA1bRiNQeRclCy6fuB5H0ADG7AEwn96oKrqXIDJkRkby6zZlgt7tH8yg2A3mHgv4MLnTbRnM8hbr/6QDMAlGuAf7rkeiDe9ZzPIW7PKY8+WqINKDwsHQiaWQ2qbp0ueRf4FrgciPcB3VfX5wLcy5jt7jHg4z5vfAdaBsNwBvTMBKr6HeaobRCq+hvwfiR3DfikgNKIITBKtAZ49daA2I6tAbFEVV0h+7O3/bF9a4CrZdVqjULqj6YWnc+HROStxP6lw2o45DQt5nH7IWUaBLgGvObUPxOReeCXxDhlYRpzmNPFtaQIiacwdwN3GP2J77xyB9idklPSELBj6zS9S9EmYAk4nTL+gbQrwLsSzmJ+IP2A0f3HH1gNZ0n8z2+W/wB24iKWc03o3QAAAABJRU5ErkJggg==";const u={class:"shopping-cart"},d={key:0},m={key:1,class:"cart-container"},A={class:"cart-items"},k={key:0,class:"cart-empty"},p={key:1},v={class:"select-all"},g={class:"item-select"},f=["value"],h={class:"item-details"},L=["src"],y={class:"quantity-container"},b={class:"quantity-control"},C=["onClick"],B=["onClick"],S=["onClick"],w={class:"checkout-block"};function I(t,e,a,r,n,I){const E=(0,l.g2)("router-link"),q=(0,l.g2)("CartForm");return(0,l.uX)(),(0,l.CE)("div",u,[r.loading?((0,l.uX)(),(0,l.CE)("div",d,"Loading...")):((0,l.uX)(),(0,l.CE)("div",m,[(0,l.Lk)("div",A,[0===r.cartItems.length?((0,l.uX)(),(0,l.CE)("div",k,[e[5]||(e[5]=(0,l.Lk)("img",{alt:"Vue logo",src:s},null,-1)),e[6]||(e[6]=(0,l.Lk)("h3",null,"В вашей корзине пусто",-1)),e[7]||(e[7]=(0,l.Lk)("p",null," Начните путь к творчеству прямо сейчас. Перейдите в каталог и добавьте товар в корзину. ",-1)),(0,l.Lk)("button",null,[(0,l.bF)(E,{to:"/catalog"},{default:(0,l.k6)((()=>e[4]||(e[4]=[(0,l.eW)("Каталог")]))),_:1})])])):((0,l.uX)(),(0,l.CE)("div",p,[(0,l.Lk)("div",v,[(0,l.Lk)("label",null,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=t=>r.allSelected=t),onChange:e[1]||(e[1]=(...t)=>r.toggleSelectAll&&r.toggleSelectAll(...t))},null,544),[[i.lH,r.allSelected]]),e[8]||(e[8]=(0,l.eW)(" Выбрать все "))])]),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.cartItems,(t=>((0,l.uX)(),(0,l.CE)("div",{key:t.id,class:"cart-item"},[(0,l.Lk)("div",g,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=t=>r.selectedItems=t),value:t.id,onChange:e[3]||(e[3]=(...t)=>r.updateSelectAll&&r.updateSelectAll(...t))},null,40,f),[[i.lH,r.selectedItems]])]),(0,l.Lk)("div",h,[(0,l.Lk)("img",{src:t.image,alt:"Изображение товара",class:"img-item"},null,8,L),(0,l.Lk)("div",null,[(0,l.Lk)("h3",null,(0,o.v_)(t.name),1),(0,l.Lk)("p",null,(0,o.v_)(t.description),1),(0,l.Lk)("p",null,"Цена: "+(0,o.v_)(t.price)+" ₽",1),(0,l.Lk)("div",y,[e[9]||(e[9]=(0,l.Lk)("p",null,"Количество:",-1)),(0,l.Lk)("div",b,[(0,l.Lk)("button",{onClick:e=>r.decreaseQuantity(t.id)},"-",8,C),(0,l.Lk)("span",null,(0,o.v_)(t.quantity),1),(0,l.Lk)("button",{onClick:e=>r.increaseQuantity(t.id)},"+",8,B)])])]),(0,l.Lk)("button",{onClick:e=>r.removeFromCart(t.id)},e[10]||(e[10]=[(0,l.Lk)("img",{src:c,alt:""},null,-1)]),8,S)])])))),128))]))]),(0,l.Lk)("div",w,[(0,l.bF)(q,{selectedItems:r.selectedCartItems,totalQuantity:r.totalSelectedQuantity,totalPrice:r.totalSelectedPrice},null,8,["selectedItems","totalQuantity","totalPrice"])])]))])}a(8992),a(4520),a(2577),a(3949),a(1454),a(8872);var E=a(953),q=a(6278);const R={class:"checkout-form"},U={class:"summary"},P={class:"form-group"},V={class:"form-group"},K={class:"form-group"};function Q(t,e,a,r,n,s){return(0,l.uX)(),(0,l.CE)("div",R,[e[0]||((0,l.Vq)(-1,!0),(e[0]=(0,l.Lk)("h3",null,[e[5]||(e[5]=(0,l.eW)("Оформление заказа"))])).cacheIndex=0,(0,l.Vq)(1),e[0]),(0,l.Lk)("div",U,[(0,l.Lk)("p",null,[e[6]||(e[6]=(0,l.Lk)("strong",null,"Общее количество товаров:",-1)),(0,l.eW)(" "+(0,o.v_)(a.totalQuantity),1)]),(0,l.Lk)("p",null,[e[7]||(e[7]=(0,l.Lk)("strong",null,"Итоговая цена:",-1)),(0,l.eW)(" "+(0,o.v_)(a.totalPrice)+" ₽",1)]),(0,l.Lk)("p",null,[e[8]||(e[8]=(0,l.Lk)("strong",null,"Доставка:",-1)),(0,l.eW)(" "+(0,o.v_)(s.shippingStatus),1)])]),(0,l.Lk)("form",{onSubmit:e[4]||(e[4]=(0,i.D$)(((...t)=>s.submitOrder&&s.submitOrder(...t)),["prevent"]))},[(0,l.Lk)("div",P,[e[9]||(e[9]=(0,l.Lk)("label",{for:"name"},"Имя:",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"name","onUpdate:modelValue":e[1]||(e[1]=t=>n.formData.name=t),required:""},null,512),[[i.Jo,n.formData.name]])]),(0,l.Lk)("div",V,[e[10]||(e[10]=(0,l.Lk)("label",{for:"address"},"Адрес:",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"address","onUpdate:modelValue":e[2]||(e[2]=t=>n.formData.address=t),required:""},null,512),[[i.Jo,n.formData.address]])]),(0,l.Lk)("div",K,[e[11]||(e[11]=(0,l.Lk)("label",{for:"email"},"Email:",-1)),(0,l.bo)((0,l.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":e[3]||(e[3]=t=>n.formData.email=t),required:""},null,512),[[i.Jo,n.formData.email]])]),e[12]||(e[12]=(0,l.Lk)("button",{type:"submit"},"Оформить заказ",-1))],32)])}var D={props:{selectedItems:{type:Array,required:!0},totalQuantity:{type:Number,required:!0},totalPrice:{type:Number,required:!0}},data(){return{formData:{name:"",address:"",email:""}}},computed:{shippingStatus(){return this.totalPrice>=5e3?"Бесплатная":"500 ₽"}},methods:{submitOrder(){const t={...this.formData,totalQuantity:this.totalQuantity,totalPrice:this.totalPrice,shipping:this.shippingStatus,items:this.selectedItems};console.log("Order submitted:",t),alert("Заказ успешно оформлен!")}}},F=a(6262);const O=(0,F.A)(D,[["render",Q],["__scopeId","data-v-5611461c"]]);var x=O,W={components:{CartForm:x},setup(){const t=(0,q.Pj)(),e=(0,E.KR)([]),a=(0,E.KR)(!0),r=(0,E.KR)(parseInt(sessionStorage.getItem("userId"))),n=(0,E.KR)([]),i=(0,E.KR)(!1),o=(0,l.EW)((()=>r.value?e.value:t.state.cart)),s=(0,l.EW)((()=>o.value.filter((t=>n.value.includes(t.id))))),c=(0,l.EW)((()=>s.value.reduce(((t,e)=>t+e.quantity),0))),u=(0,l.EW)((()=>s.value.reduce(((t,e)=>t+e.price*e.quantity),0))),d=async()=>{try{if(!r.value)return o.value=t.state.cart;{const t=await fetch("https://faa45a9033a909b4.mokky.dev/users"),a=await t.json();a.forEach((t=>{if(t.id==r.value){const a=t.items.map((t=>t.product));console.log("Значения product:",a),e.value=a}}))}}catch(l){console.error("Error fetching cart items:",l)}finally{a.value=!1}},m=e=>{r.value?A(e):t.dispatch("removeFromCart",e)},A=async t=>{try{const a=await fetch("https://faa45a9033a909b4.mokky.dev/users",{method:"GET"});if(!a.ok)throw new Error(`Ошибка при получении пользователей: ${a.status} ${a.statusText}`);const l=await a.json();if(!l||0===l.length)return void alert("Пользователь не найден.");const n=l.find((t=>t.id===r.value));if(!n)return void alert("Пользователь не найден.");const i=n.items.filter((e=>e.product.id!==t)),o=await fetch(`https://faa45a9033a909b4.mokky.dev/users/${r.value}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:i})});if(!o.ok)throw new Error(`Ошибка при обновлении корзины: ${o.status}`);e.value=e.value.filter((e=>e.id!==t)),alert("Товар удален из корзины!")}catch(a){console.error(a),alert("Ошибка при удалении товара из корзины")}},k=t=>{const e=o.value.find((e=>e.id===t));e&&(e.quantity+=1)},p=t=>{const e=o.value.find((e=>e.id===t));e&&e.quantity>1&&(e.quantity-=1)},v=()=>{i.value?n.value=o.value.map((t=>t.id)):n.value=[]},g=()=>{i.value=n.value.length===o.value.length};return(0,l.sV)((()=>{d()})),{loading:a,cartItems:o,selectedItems:n,allSelected:i,selectedCartItems:s,totalSelectedQuantity:c,totalSelectedPrice:u,removeFromCart:m,increaseQuantity:k,decreaseQuantity:p,toggleSelectAll:v,updateSelectAll:g}}};const H=(0,F.A)(W,[["render",I],["__scopeId","data-v-966ce798"]]);var N=H,J={name:"CartView",components:{CartComponent:N}};const T=(0,F.A)(J,[["render",n]]);var X=T},7588:function(t,e,a){var l=a(6518),r=a(2652),n=a(9306),i=a(8551),o=a(1767);l({target:"Iterator",proto:!0,real:!0},{forEach:function(t){i(this),n(t);var e=o(this),a=0;r(e,(function(e){t(e,a++)}),{IS_RECORD:!0})}})},8237:function(t,e,a){var l=a(6518),r=a(2652),n=a(9306),i=a(8551),o=a(1767),s=TypeError;l({target:"Iterator",proto:!0,real:!0},{reduce:function(t){i(this),n(t);var e=o(this),a=arguments.length<2,l=a?void 0:arguments[1],c=0;if(r(e,(function(e){a?(a=!1,l=e):l=t(l,e,c),c++}),{IS_RECORD:!0}),a)throw new s("Reduce of empty iterator with no initial value");return l}})},3949:function(t,e,a){a(7588)},8872:function(t,e,a){a(8237)}}]);
//# sourceMappingURL=208.474c4357.js.map